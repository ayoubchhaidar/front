
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<div class="button-container">
  <a (click)="toggleSection('information')" [class.active]="showInformation">Information</a>
  <a  (click)="toggleSection('content')" [class.active]="showContent">Contenu</a>
</div>


<div *ngIf="showInformation">
  <main>
    <h2>Information</h2>
    <div class="lesson">
     <p>
  <span style="font-weight: bold; color: #333;">Titre :</span>
  {{ getCourseById(CourseId)?.title }}<br>
  <span style="font-weight: bold; color: #333;">Description :</span>
  {{ getCourseById(CourseId)?.description }}
</p>

    </div>
    <div class="lesson">
      <p style="font-weight: bold; color: #333;">Contenu :</p>
      <div class="lesson-header-container">
     
        <div  class="lesson-header" *ngFor="let lesson of lessons; let i = index" [attr.id]="'lesson-' + lesson.id">
          <p class="lesson-number"><span>{{ i + 1 }}</span></p>
          <h1 class="lesson-title">{{ lesson.title }}</h1>
        </div>
      </div>
    </div>
    
  </main>

</div>

<main id="course-content" *ngIf="showContent">
    

    <!-- The Material Type Modal -->
    <div id="materialModal" class="modal">
        <div class="modal-content">
            <span class="close" (click)="closeMaterialModal()">&times;</span>
            <h4 *ngIf="update==false && eval==false" style="text-align: center; color: #4e73df;">Add Material</h4>
            <h4 *ngIf="update==true" style="text-align: center; color: #4e73df;">Update Material</h4>
            <h4 *ngIf="eval==true" style="text-align: center; color: #4e73df;">Add Evaluation</h4>
            <form (ngSubmit)="update ? UpdateMaterial(selectedmatId): AddMaterial(selectedLessonId)" #myForm="ngForm">
              
              <div class="form-group">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" [(ngModel)]="myform.value['title']" required #Input="ngModel">
                <div *ngIf="(Input.invalid) && (Input.dirty || Input.touched )" class="error-message">
                  Title is required.
                </div>
            
                <label for="document_type">Document Type:</label>
                <mat-select [(ngModel)]="myform.value['document_type']" id="document_type" name="document_type" class="form-control" required color="blue" #Input="ngModel">
                  <mat-option disabled selected>Select Document Type</mat-option>
                  <div *ngIf="eval===false">
                  <mat-option value="pdf">
                    <mat-icon class="icon">picture_as_pdf</mat-icon> PDF
                  </mat-option>
                  <mat-option value="docx">
                    <mat-icon class="icon">description</mat-icon> Docx
                  </mat-option>
                  <mat-option value="pptx">
                    <mat-icon class="icon">slideshow</mat-icon> Pr√©sentation (PPTX)
                </mat-option>
                  <mat-option value="youtube">
                    <mat-icon class="icon">video_library</mat-icon>YouTube
                  </mat-option>
                  <mat-option value="video">
                    <mat-icon class="icon">video_library</mat-icon>Video
                  </mat-option>
                </div>
                  <!-- <div *ngIf="eval===true">
                  <mat-option value="quiz" >
                    <mat-icon class="icon">live_help</mat-icon> Quiz
                  </mat-option>
                  <mat-option value="exercise">
                    <mat-icon class="icon">fitness_center</mat-icon> Exercise
                  </mat-option>
                </div> -->
                  <!-- Add more options with corresponding icons as needed -->
                </mat-select>
              
                <div *ngIf="Input.invalid && (Input.dirty || Input.touched)" class="error-message">
                  Document Type is required.
                </div>
            
                <div *ngIf="myform.value['document_type'] === 'youtube'">
                  <label for="youtube_url">YouTube URL:</label>
                  <input  type="text" id="youtube_url" name="youtube_url" class="form-control" [(ngModel)]="uploadedLink" required #youtubeUrl="ngModel" />
                  <div *ngIf="youtubeUrl.invalid && (youtubeUrl.dirty || youtubeUrl.touched)" class="error-message">
                    YouTube URL is required.
                  </div>
                  
                </div>
                <div *ngIf="myform.value['document_type'] === 'video'">
                  <label for="youtube_url">drive link for ur video:</label>
                  <input  type="text" id="youtube_url" name="youtube_url" class="form-control" [(ngModel)]="uploadedLink" required #youtubeUrl="ngModel" />
                  <div *ngIf="youtubeUrl.invalid && (youtubeUrl.dirty || youtubeUrl.touched)" class="error-message">
                    drive link is required.
                  </div>
                
                </div>
            
                <div *ngIf="['pdf','docx'].includes(myform.value['document_type'])">
                  <label for="file">File Upload</label>
                  <input type="file" id="file" name="content" (change)="onFileSelected($event)" [(ngModel)]="selectedFile" required #Input="ngModel" />
                  <div *ngIf="Input.invalid && (Input.dirty || Input.touched)" class="error-message">
                    File Upload is required.
                  </div>
                </div>
                <div *ngIf="myform.value['document_type'] === 'pptx'">>
                  <label for="file">File Upload</label>
                  <input type="file" id="file" name="content" (change)="onFileSelected($event)" [(ngModel)]="selectedFile" required #Input="ngModel" />
                  <div *ngIf="Input.invalid && (Input.dirty || Input.touched)" class="error-message">
                    File Upload is required.
                  </div>
                </div>
            
                <div *ngIf="errorMessage" class="error-message">
                  {{ errorMessage }}
                </div>
                      <!-- your-file.html -->
                <button *ngIf="myForm.valid && uploadedLink !== '' && errorMessage == '' && !update" type="submit">Add Material</button>
  <button *ngIf="myForm.valid && uploadedLink !== '' && errorMessage == '' && update" type="submit">Update Material</button>
              </div>
            </form>
            
        </div>
    </div>
    

 <!-- Your Lessons Iteration -->
 <div *ngFor="let lesson of lessons; let i = index" class="lesson" [attr.id]="'lesson-' + lesson.id">
  <button class="add-material-button" (click)="openMaterialModal(lesson?.id, 0, false,false)">
    <i class="fas fa-plus"></i> Add Material
  </button>
  <button class="add-material-button" style="margin-left: 500px;"  (click)="openMaterialModaleval()">
    <i class="fas fa-plus"></i> Add Evaluation
  </button>
  <div id="materialModaleval" class="modal">
    <div class="modal-content">  
      <span class="close" (click)="closeMaterialModal()">&times;</span>
      <h4  style="text-align: center; color: #4e73df;">select</h4>
      <a  [routerLink]="['/dashboard/quiz']"
      [queryParams]="{ courseId: CourseId, lessonId: lesson.id }">quiz</a><br>
      <a>exercise</a><br>
  </div>
</div>
  <button (click)="delete_lesson(lesson.id)" class="delete-button">
    <i class="fas fa-trash-alt"></i> Delete
  </button>
  
  <div class="lesson-content">
    <div class="lesson-header">
      <p class="lesson-number"><span>{{ i + 1 }}</span></p>
      <h1 class="lesson-title">
        <span *ngIf="!lesson.isEditing" (click)="enableLessonEdit(lesson)">{{ lesson.title }}</span>
        <input *ngIf="lesson.isEditing" type="text" [(ngModel)]="lesson.newTitle" (keyup.enter)="updateLessonTitle(lesson)" >
        <button type="button" *ngIf="lesson.isEditing" (click)="updateLessonTitle(lesson)">Save</button>
      </h1>
      <button class="button-link" (click)="toggleMaterials(lesson)">Show More</button>
    </div>
    <div id="yourListItemId" class="your-list-item">
      <!-- Material content -->
    

 
     
        <div *ngIf="lesson.showMaterials" class="materials-container">
            <div *ngFor="let mat of lesson.mateials" class="material-item" (mouseenter)="onMouseEnter(mat.id)" (mouseleave)="onMouseLeave()">
              
                <!-- Add an icon based on the material type -->
                  <mat-icon class="icon">{{ getMaterialIcon(mat.document_type) }}</mat-icon> 
                   <span class="material-title">{{ mat.title }}</span>
              
              <div class="material-actions" *ngIf="hoveredItemId === mat.id">
              
                <button (click)="openMaterialModalpreview(mat)" class="material-action">
                  <i class="fas fa-eye"></i> <!-- Font Awesome eye icon -->
                </button>

                <div id="materialModalpreview" class="modal"  >
                  <div class="modal-content">
                    <span class="close" (click)="closeMaterialModal()">&times;</span>
                    <h4  style="text-align: center; color: #4e73df;">mat</h4>
                    <form >
                      
                    <!-- <iframe [src]="mat.content" height="1100px" width="100%" frameborder="0" ></iframe>  -->
                      <!-- <ngx-extended-pdf-viewer [src]="mat.content" [textLayer]="true"></ngx-extended-pdf-viewer> 
                      
                      -->

                      <ngx-doc-viewer
                      [url]="mat.content"
                      viewer="url"
                      style="width:100%;height:500px;"
                    >
                    </ngx-doc-viewer> 
                  
                  
                    
                    </form>  
                    
                  </div>
                </div>
                
                <button (click)="openMaterialModal(lesson.id, mat, true,false)" class="material-action">
                  <i class="fas fa-edit"></i> <!-- Font Awesome edit icon -->
                </button>



<button (click)="delete_mat(mat.id)" class="material-action">
  <i class="fas fa-trash-alt"></i> <!-- Font Awesome trash icon -->
</button>
              </div>
            </div>
            </div>
          </div>
          
          
          
          
        
        <hr>
    </div>
</div>

   
        
       
<div id="materialModallesson" class="modal">
  <div class="modal-content">
    
    <span class="close" (click)="closeMaterialModal()">&times;</span>
    <h4  style="text-align: center; color: #4e73df;">Add Lesson</h4>
    <form #materialForm="ngForm" (ngSubmit)="addLesson()">
      <div class="form-group">
      <label for="title">Title:</label>
      <input type="text" id="title" name="title" [(ngModel)]="newLessonTitle" required #Input="ngModel">
      <div *ngIf="(Input.invalid) && (Input.dirty || Input.touched)" class="error-message">
        Title is required.
      </div>
      <button *ngIf="newLessonTitle!=''" type="submit">Add</button>
    </div>
    </form>
  </div>
</div>

<div class="button-container">
  <button class="button_plus" (click)="openMaterialModallesson()"></button>
  <a class="add-section" (click)="openMaterialModallesson()">Add Section</a>
</div>

</main>
